<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="/images/favicon.ico">
    <title>Doowon Portal - ì£¼ê°„ë³´ê³ ê´€ë¦¬</title>
    <link rel="stylesheet" type="text/css" href="css/style.css" />
    <link rel="stylesheet" type="text/css" href="css/darkmode.css" />
</head>

<body>
    <header class="header">
        <div class="logo"><a href="http://211.238.111.33:8080/cb/"><img src="images/doowon_logo.png" alt="Logo" /></a></div>
        <div class="title-container"><h1>Doowon Portal</h1><p>ë‘ì›ê³µì¡° í¬íƒˆ</p></div>
        <div class="menu-container">
            <span class="menu-item"><img src="images/user.svg" alt="User" /><%= username %></span>
            <a href="#" class="menu-item" onclick="handleLogout()"><img src="images/logout.svg" alt="Logout" />Logout</a>
        </div>                  
    </header>

    <nav class="main-nav">
        <div class="nav-container">
            <a href="/" class="nav-item <%= currentPath === '/' ? 'active' : '' %>">
                <img src="images/home.svg" alt="Home" />
                <span>ëŒ€ì‹œë³´ë“œ</span>
            </a>
            <a href="/weekly-reports" class="nav-item <%= currentPath === '/weekly-reports' ? 'active' : '' %>">
                <img src="images/settings.svg" alt="Weekly Reports" />
                <span>ì£¼ê°„ë³´ê³ ê´€ë¦¬</span>
            </a>
            <a href="/travel-reports" class="nav-item <%= currentPath === '/travel-reports' ? 'active' : '' %>">
                <img src="images/settings.svg" alt="Travel Reports" />
                <span>ì¶œì¥ë³´ê³ ê´€ë¦¬</span>
            </a>
            <a href="/hardware-management" class="nav-item <%= currentPath === '/hardware-management' ? 'active' : '' %>">
                <img src="images/settings.svg" alt="Hardware Management" />
                <span>í•˜ë“œì›¨ì–´ê´€ë¦¬</span>
            </a>
            <a href="/equipment-management" class="nav-item <%= currentPath === '/equipment-management' ? 'active' : '' %>">
                <img src="images/settings.svg" alt="Equipment Management" />
                <span>ì¥ë¹„ê´€ë¦¬</span>
            </a>
            <a href="/external-training" class="nav-item <%= currentPath === '/external-training' ? 'active' : '' %>">
                <img src="images/settings.svg" alt="External Training" />
                <span>ì™¸ë¶€êµìœ¡ê´€ë¦¬</span>
            </a>
        </div>
    </nav>

    <div class="main-container">
        <div class="page-header">
            <h2>ğŸ“Š ì£¼ê°„ë³´ê³ ê´€ë¦¬</h2>
            <p>ì£¼ê°„ ë³´ê³ ì„œë¥¼ ì‘ì„±, ì œì¶œ ë° ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
        </div>

        <div class="content-section">
            <div class="section-header">
                <h3>ìƒˆ ì£¼ê°„ë³´ê³  ì‘ì„±</h3>
                <button class="btn-primary" onclick="showCreateForm()">+ ìƒˆ ë³´ê³ ì„œ ì‘ì„±</button>
            </div>

            <div class="create-form" id="createForm" style="display: none;">
                <form id="weeklyReportForm">
                    <div class="form-group">
                        <label for="reportTitle">ë³´ê³ ì„œ ì œëª©</label>
                        <input type="text" id="reportTitle" name="title" required placeholder="ì£¼ê°„ë³´ê³ ì„œ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="reportWeek">ë³´ê³  ì£¼ì°¨</label>
                            <input type="week" id="reportWeek" name="week" required>
                        </div>
                        <div class="form-group">
                            <label for="reportDate">ì‘ì„±ì¼</label>
                            <input type="date" id="reportDate" name="date" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="businessDivision">ì‚¬ì—…ë¶€</label>
                        <select id="businessDivision" name="businessDivision" required>
                            <option value="">ì‚¬ì—…ë¶€ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                            <option value="ê¸°ìˆ ê°œë°œë¶€">ê¸°ìˆ ê°œë°œë¶€</option>
                            <option value="ì˜ì—…ë¶€">ì˜ì—…ë¶€</option>
                            <option value="ìƒì‚°ë¶€">ìƒì‚°ë¶€</option>
                            <option value="í’ˆì§ˆê´€ë¦¬ë¶€">í’ˆì§ˆê´€ë¦¬ë¶€</option>
                            <option value="ì¸ì‚¬ë¶€">ì¸ì‚¬ë¶€</option>
                            <option value="ì´ë¬´ë¶€">ì´ë¬´ë¶€</option>
                            <option value="ì¬ë¬´ë¶€">ì¬ë¬´ë¶€</option>
                            <option value="ë§ˆì¼€íŒ…ë¶€">ë§ˆì¼€íŒ…ë¶€</option>
                            <option value="êµ¬ë§¤ë¶€">êµ¬ë§¤ë¶€</option>
                            <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>ë³´ê³  ë‚´ìš©</label>
                        <div class="report-tabs">
                            <div class="tab-buttons">
                                <button type="button" class="tab-btn active" onclick="switchTab('thisWeek')">ê¸ˆì£¼ ì£¼ê°„ë³´ê³ </button>
                                <button type="button" class="tab-btn" onclick="switchTab('nextWeek')">ì°¨ì£¼ ì£¼ê°„ë³´ê³ </button>
                            </div>
                            <div class="tab-content">
                                <div id="thisWeekTab" class="tab-pane active">
                                    <textarea id="thisWeekContent" name="thisWeekContent" rows="8" placeholder="ì´ë²ˆ ì£¼ ì£¼ìš” ì—…ë¬´ ë‚´ìš©ì„ ì‘ì„±í•˜ì„¸ìš”..."></textarea>
                                </div>
                                <div id="nextWeekTab" class="tab-pane">
                                    <textarea id="nextWeekContent" name="nextWeekContent" rows="8" placeholder="ë‹¤ìŒ ì£¼ ê³„íš ë° ì˜ˆì • ì—…ë¬´ë¥¼ ì‘ì„±í•˜ì„¸ìš”..."></textarea>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="reportAttachments">ì²¨ë¶€íŒŒì¼</label>
                        <input type="file" id="reportAttachments" name="attachments" multiple accept=".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx">
                        <small>ì§€ì› í˜•ì‹: PDF, DOC, DOCX, XLS, XLSX, PPT, PPTX</small>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="hideCreateForm()">ì·¨ì†Œ</button>
                        <button type="submit" class="btn-primary">ë³´ê³ ì„œ ì €ì¥</button>
                    </div>
                </form>
            </div>
        </div>

        <div class="content-section">
            <div class="section-header">
                <h3>ì£¼ê°„ë³´ê³  ëª©ë¡</h3>
                <div class="filter-controls">
                    <select id="statusFilter" onchange="filterReports()">
                        <option value="">ì „ì²´ ìƒíƒœ</option>
                        <option value="draft">ì„ì‹œì €ì¥</option>
                        <option value="submitted">ì œì¶œë¨</option>
                        <option value="approved">ìŠ¹ì¸ë¨</option>
                        <option value="rejected">ë°˜ë ¤ë¨</option>
                    </select>
                    <input type="month" id="monthFilter" onchange="filterReports()" placeholder="ì›”ë³„ í•„í„°">
                </div>
            </div>

            <div class="reports-list" id="reportsList">
                <div class="report-item">
                    <div class="report-header">
                        <h4>2024ë…„ 1ì›” 1ì£¼ì°¨ ì£¼ê°„ë³´ê³ </h4>
                        <span class="report-status status-draft">ì„ì‹œì €ì¥</span>
                    </div>
                    <div class="report-meta">
                        <span>ì‘ì„±ì¼: 2024-01-05</span>
                        <span>ë³´ê³ ì£¼ì°¨: 2024-W01</span>
                        <span>ì‚¬ì—…ë¶€: ê¸°ìˆ ê°œë°œë¶€</span>
                    </div>
                    <div class="report-actions">
                        <button class="btn-small btn-primary" onclick="editReport(1)">ìˆ˜ì •</button>
                        <button class="btn-small btn-success" onclick="submitReport(1)">ì œì¶œ</button>
                        <button class="btn-small btn-danger" onclick="deleteReport(1)">ì‚­ì œ</button>
                    </div>
                </div>

                <div class="report-item">
                    <div class="report-header">
                        <h4>2023ë…„ 12ì›” 4ì£¼ì°¨ ì£¼ê°„ë³´ê³ </h4>
                        <span class="report-status status-submitted">ì œì¶œë¨</span>
                    </div>
                    <div class="report-meta">
                        <span>ì‘ì„±ì¼: 2023-12-28</span>
                        <span>ë³´ê³ ì£¼ì°¨: 2023-W52</span>
                        <span>ì‚¬ì—…ë¶€: ì˜ì—…ë¶€</span>
                    </div>
                    <div class="report-actions">
                        <button class="btn-small btn-info" onclick="viewReport(2)">ë³´ê¸°</button>
                        <button class="btn-small btn-secondary" onclick="downloadReport(2)">ë‹¤ìš´ë¡œë“œ</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function handleLogout() {
            fetch('/logout', { method: 'GET' })
                .then(() => window.location.href = '/login')
                .catch(error => console.error('Logout error:', error));
        }

        function showCreateForm() {
            document.getElementById('createForm').style.display = 'block';
            document.getElementById('reportDate').value = new Date().toISOString().split('T')[0];
        }

        function hideCreateForm() {
            document.getElementById('createForm').style.display = 'none';
            document.getElementById('weeklyReportForm').reset();
        }

        function filterReports() {
            const statusFilter = document.getElementById('statusFilter').value;
            const monthFilter = document.getElementById('monthFilter').value;
            
            console.log('Filtering reports by status:', statusFilter, 'month:', monthFilter);
        }

        function editReport(id) {
            console.log('Editing report:', id);
            showCreateForm();
        }

        function submitReport(id) {
            console.log('Submitting report:', id);
        }

        function deleteReport(id) {
            if (confirm('ì •ë§ë¡œ ì´ ë³´ê³ ì„œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                console.log('Deleting report:', id);
            }
        }

        function viewReport(id) {
            console.log('Viewing report:', id);
        }

        function downloadReport(id) {
            console.log('Downloading report:', id);
        }

        function switchTab(tabName) {
            // Remove active class from all tabs and panes
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-pane').forEach(pane => pane.classList.remove('active'));
            
            // Add active class to selected tab and pane
            document.querySelector(`[onclick="switchTab('${tabName}')"]`).classList.add('active');
            document.getElementById(`${tabName}Tab`).classList.add('active');
        }

        document.getElementById('weeklyReportForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Get form data
            const formData = {
                title: document.getElementById('reportTitle').value,
                week: document.getElementById('reportWeek').value,
                date: document.getElementById('reportDate').value,
                businessDivision: document.getElementById('businessDivision').value,
                thisWeekContent: document.getElementById('thisWeekContent').value,
                nextWeekContent: document.getElementById('nextWeekContent').value,
                attachments: document.getElementById('reportAttachments').files
            };
            
            console.log('Saving weekly report with form data:', formData);
            hideCreateForm();
        });
    </script>
</body>
</html>
