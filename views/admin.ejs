<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="/images/favicon.ico">
    <title>Doowon Portal - Admin Settings</title>
    <link rel="stylesheet" type="text/css" href="css/style.css" />
    <link rel="stylesheet" type="text/css" href="css/darkmode.css" />
    <link rel="stylesheet" type="text/css" href="css/table.css" />
    <style>
        .vehicle-type-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .vehicle-type-input {
            flex: 1;
        }
        
        .btn-small {
            padding: 4px 8px;
            font-size: 12px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
        }
        
        .btn-danger {
            background: #dc3545;
            color: white;
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-info {
            background: #17a2b8;
            color: white;
        }
        
        .vehicle-type-config {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .field-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .field-item .field-mapping-input {
            flex: 1;
        }
    </style>
</head>

<body>
    <div class="admin-header">
        <h1>âš™ï¸ Admin Settings</h1>
        <p>Codebeamer í•„ë“œ ë§¤í•‘ ë° ì‹œìŠ¤í…œ ì„¤ì • ê´€ë¦¬</p>
    </div>

    <nav class="admin-nav">
        <div class="admin-nav-container">
            <div class="admin-nav-title">ê´€ë¦¬ì íŒ¨ë„</div>
            <div class="admin-nav-actions">
                <span class="admin-username">ê´€ë¦¬ì: <%= username %></span>
                <a href="/admin/logout" class="btn-admin btn-secondary">ë¡œê·¸ì•„ì›ƒ</a>
            </div>
        </div>
    </nav>

    <div class="admin-section">
        <div class="codebeamer-info">
            <h4>ğŸ”— Codebeamer ì—°ê²° ì •ë³´</h4>
            <div class="info-item">
                <span class="info-label">ì„œë²„ URL:</span>
                <span class="info-value"><%= serverUrl %></span>
            </div>
            <div class="info-item">
                <span class="info-label">ì—°ê²° ìƒíƒœ:</span>
                <span class="info-value" id="connectionStatus">í™•ì¸ ì¤‘...</span>
            </div>
        </div>

        <div class="mapping-summary">
            <h4>ğŸ“Š í•„ë“œ ë§¤í•‘ í˜„í™©</h4>
            <div class="mapping-stats">
                <div class="stat-item">
                    <span class="status-indicator status-mapped"></span>
                    <span>ë§¤í•‘ ì™„ë£Œ: <strong id="mappedCount">0</strong>ê°œ</span>
                </div>
                <div class="stat-item">
                    <span class="status-indicator status-pending"></span>
                    <span>ë§¤í•‘ ëŒ€ê¸°: <strong id="pendingCount">0</strong>ê°œ</span>
                </div>
                <div class="stat-item">
                    <span class="status-indicator status-unmapped"></span>
                    <span>ë§¤í•‘ í•„ìš”: <strong id="unmappedCount">0</strong>ê°œ</span>
                </div>
            </div>
        </div>

        <!-- ì£¼ê°„ë³´ê³ ê´€ë¦¬ í•„ë“œ ë§¤í•‘ -->
        <div class="section-card">
            <div class="section-header">
                <h3>ğŸ“Š ì£¼ê°„ë³´ê³ ê´€ë¦¬ í•„ë“œ ë§¤í•‘</h3>
                <p>ì£¼ê°„ë³´ê³ ì„œì˜ ê° í•„ë“œë¥¼ Codebeamerì˜ í•´ë‹¹ í•„ë“œì™€ ë§¤í•‘í•©ë‹ˆë‹¤.</p>
            </div>
            <div class="section-content">
                <div class="field-mapping">
                    <div class="field-group">
                        <h4>ê¸°ë³¸ ì •ë³´</h4>
                        <div class="field-item">
                            <span class="field-label">ë³´ê³ ì„œ ì œëª©</span>
                            <input type="text" class="field-mapping-input" value="name" readonly>
                        </div>
                        <div class="field-item">
                            <span class="field-label">ë³´ê³  ì£¼ì°¨</span>
                            <input type="text" class="field-mapping-input" value="custom_field_1">
                        </div>
                        <div class="field-item">
                            <span class="field-label">ì‘ì„±ì¼</span>
                            <input type="text" class="field-mapping-input" value="submittedAt" readonly>
                        </div>
                        <div class="field-item">
                            <span class="field-label">ì‚¬ì—…ë¶€</span>
                            <input type="text" class="field-mapping-input" value="custom_field_2">
                        </div>
                    </div>
                    <div class="field-group">
                        <h4>ë³´ê³  ë‚´ìš©</h4>
                        <div class="field-item">
                            <span class="field-label">ê¸ˆì£¼ ì£¼ê°„ë³´ê³ </span>
                            <input type="text" class="field-mapping-input" value="custom_field_3">
                        </div>
                        <div class="field-item">
                            <span class="field-label">ì°¨ì£¼ ì£¼ê°„ë³´ê³ </span>
                            <input type="text" class="field-mapping-input" value="custom_field_4">
                        </div>
                        <div class="field-item">
                            <span class="field-label">ì²¨ë¶€íŒŒì¼</span>
                            <input type="text" class="field-mapping-input" value="attachments">
                        </div>
                        <div class="field-item">
                            <span class="field-label">ìƒíƒœ</span>
                            <input type="text" class="field-mapping-input" value="status" readonly>
                        </div>
                    </div>
                </div>
                <div class="admin-button-container">
                    <button class="btn-admin btn-primary" onclick="saveMapping('weekly-reports')">ë§¤í•‘ ì €ì¥</button>
                    <button class="btn-admin btn-warning" onclick="testMapping('weekly-reports')">ë§¤í•‘ í…ŒìŠ¤íŠ¸</button>
                </div>
            </div>
        </div>

        <!-- ì¶œì¥ë³´ê³ ê´€ë¦¬ í•„ë“œ ë§¤í•‘ -->
        <div class="section-card">
            <div class="section-header">
                <h3>âœˆï¸ ì¶œì¥ë³´ê³ ê´€ë¦¬ í•„ë“œ ë§¤í•‘</h3>
                <p>ì¶œì¥ë³´ê³ ì„œì˜ ê° í•„ë“œë¥¼ Codebeamerì˜ í•´ë‹¹ í•„ë“œì™€ ë§¤í•‘í•©ë‹ˆë‹¤.</p>
            </div>
            <div class="section-content">
                <div class="field-mapping">
                    <div class="field-group">
                        <h4>ê¸°ë³¸ ì •ë³´</h4>
                        <div class="field-item">
                            <span class="field-label">ë³´ê³ ì„œ ì œëª©</span>
                            <input type="text" class="field-mapping-input" value="name" readonly>
                        </div>
                        <div class="field-item">
                            <span class="field-label">ì¶œì¥ì§€</span>
                            <input type="text" class="field-mapping-input" value="custom_field_5">
                        </div>
                        <div class="field-item">
                            <span class="field-label">ì¶œì¥ ëª©ì </span>
                            <input type="text" class="field-mapping-input" value="custom_field_6">
                        </div>
                        <div class="field-item">
                            <span class="field-label">ì¶œë°œì¼</span>
                            <input type="text" class="field-mapping-input" value="custom_field_7">
                        </div>
                        <div class="field-item">
                            <span class="field-label">ê·€í™˜ì¼</span>
                            <input type="text" class="field-mapping-input" value="custom_field_8">
                        </div>
                    </div>
                    <div class="field-group">
                        <h4>ìƒì„¸ ì •ë³´</h4>
                        <div class="field-item">
                            <span class="field-label">ë™í–‰ì</span>
                            <input type="text" class="field-mapping-input" value="custom_field_9">
                        </div>
                        <div class="field-item">
                            <span class="field-label">êµí†µë¹„</span>
                            <input type="text" class="field-mapping-input" value="custom_field_10">
                        </div>
                        <div class="field-item">
                            <span class="field-label">ìˆ™ë°•ë¹„</span>
                            <input type="text" class="field-mapping-input" value="custom_field_11">
                        </div>
                        <div class="field-item">
                            <span class="field-label">ì‹ë¹„</span>
                            <input type="text" class="field-mapping-input" value="custom_field_12">
                        </div>
                        <div class="field-item">
                            <span class="field-label">ê¸°íƒ€ ê²½ë¹„</span>
                            <input type="text" class="field-mapping-input" value="custom_field_13">
                        </div>
                        <div class="field-item">
                            <span class="field-label">ì¶œì¥ ë‚´ìš©</span>
                            <input type="text" class="field-mapping-input" value="description">
                        </div>
                    </div>
                </div>
                <div class="admin-button-container">
                    <button class="btn-admin btn-primary" onclick="saveMapping('travel-reports')">ë§¤í•‘ ì €ì¥</button>
                    <button class="btn-admin btn-warning" onclick="testMapping('travel-reports')">ë§¤í•‘ í…ŒìŠ¤íŠ¸</button>
                </div>
            </div>
        </div>

        <!-- í•˜ë“œì›¨ì–´ê´€ë¦¬ í•„ë“œ ë§¤í•‘ -->
        <div class="section-card">
            <div class="section-header">
                <h3>ğŸ’» í•˜ë“œì›¨ì–´ê´€ë¦¬ í•„ë“œ ë§¤í•‘</h3>
                <p>í•˜ë“œì›¨ì–´ ê´€ë¦¬ì˜ ê° í•„ë“œë¥¼ Codebeamerì˜ í•´ë‹¹ í•„ë“œì™€ ë§¤í•‘í•©ë‹ˆë‹¤.</p>
            </div>
            <div class="section-content">
                <div class="field-mapping">
                    <div class="field-group">
                        <h4>í•˜ë“œì›¨ì–´ ì •ë³´</h4>
                        <div class="field-item">
                            <span class="field-label">í•˜ë“œì›¨ì–´ëª…</span>
                            <input type="text" class="field-mapping-input" value="name" readonly>
                        </div>
                        <div class="field-item">
                            <span class="field-label">HW ë²„ì „</span>
                            <input type="text" class="field-mapping-input" value="custom_field_3" readonly>
                        </div>
                        <div class="field-item">
                            <span class="field-label">SW ë²„ì „</span>
                            <input type="text" class="field-mapping-input" value="custom_field_10002" readonly>
                        </div>
                        <div class="field-item">
                            <span class="field-label">ì°¨ì¢…</span>
                            <input type="text" class="field-mapping-input" value="custom_field_1000" readonly>
                            <button class="btn-admin btn-info btn-small" onclick="toggleVehicleTypeConfig()" id="vehicleTypeToggleBtn">
                                <span id="vehicleTypeToggleText">ì°¨ì¢… ì„¤ì • ì—´ê¸°</span>
                            </button>
                        </div>
                        <div class="field-item">
                            <span class="field-label">ë³€ê²½ì‚¬í•­</span>
                            <input type="text" class="field-mapping-input" value="custom_field_1001" readonly>
                        </div>
                    </div>
                    <div class="field-group">
                        <h4>ì¶”ê°€ ì •ë³´</h4>
                        <div class="field-item">
                            <span class="field-label">ë³€ê²½ ì‚¬ìœ </span>
                            <input type="text" class="field-mapping-input" value="custom_field_10005" readonly>
                        </div>
                        <div class="field-item">
                            <span class="field-label">Release ì¼ì</span>
                            <input type="text" class="field-mapping-input" value="custom_field_10006" readonly>
                        </div>
                        <div class="field-item">
                            <span class="field-label">ì„¤ëª…</span>
                            <input type="text" class="field-mapping-input" value="description" readonly>
                        </div>
                        <div class="field-item">
                            <span class="field-label">ìƒíƒœ</span>
                            <input type="text" class="field-mapping-input" value="status" readonly>
                        </div>
                        <div class="field-item">
                            <span class="field-label">ë“±ë¡ì</span>
                            <input type="text" class="field-mapping-input" value="submittedBy" readonly>
                        </div>
                    </div>
                </div>
                
                <!-- Collapsible Vehicle Type Configuration -->
                <div id="vehicleTypeConfig" class="vehicle-type-config" style="display: none;">
                    <div class="field-mapping">
                        <div class="field-group">
                            <h4>ğŸš— ì°¨ì¢… ì˜µì…˜ ê´€ë¦¬</h4>
                            <p>í•˜ë“œì›¨ì–´ ê´€ë¦¬ì—ì„œ ì‚¬ìš©í•  ì°¨ì¢… ì˜µì…˜ì„ ë™ì ìœ¼ë¡œ ê´€ë¦¬í•©ë‹ˆë‹¤.</p>
                            <div id="vehicleTypeOptions">
                                <div class="vehicle-type-item">
                                    <input type="text" class="field-mapping-input vehicle-type-input" placeholder="ì°¨ì¢…ëª… ì…ë ¥" value="SW">
                                    <button class="btn-admin btn-danger btn-small" onclick="removeVehicleType(this)">ì‚­ì œ</button>
                                </div>
                                <div class="vehicle-type-item">
                                    <input type="text" class="field-mapping-input vehicle-type-input" placeholder="ì°¨ì¢…ëª… ì…ë ¥" value="OV1">
                                    <button class="btn-admin btn-danger btn-small" onclick="removeVehicleType(this)">ì‚­ì œ</button>
                                </div>
                                <div class="vehicle-type-item">
                                    <input type="text" class="field-mapping-input vehicle-type-input" placeholder="ì°¨ì¢…ëª… ì…ë ¥" value="HE1i">
                                    <button class="btn-admin btn-danger btn-small" onclick="removeVehicleType(this)">ì‚­ì œ</button>
                                </div>
                                <div class="vehicle-type-item">
                                    <input type="text" class="field-mapping-input vehicle-type-input" placeholder="ì°¨ì¢…ëª… ì…ë ¥" value="SX3">
                                    <button class="btn-admin btn-danger btn-small" onclick="removeVehicleType(this)">ì‚­ì œ</button>
                                </div>
                                <div class="vehicle-type-item">
                                    <input type="text" class="field-mapping-input vehicle-type-input" placeholder="ì°¨ì¢…ëª… ì…ë ¥" value="NQ6">
                                    <button class="btn-admin btn-danger btn-small" onclick="removeVehicleType(this)">ì‚­ì œ</button>
                                </div>
                                <div class="vehicle-type-item">
                                    <input type="text" class="field-mapping-input vehicle-type-input" placeholder="ì°¨ì¢…ëª… ì…ë ¥" value="LT2">
                                    <button class="btn-admin btn-danger btn-small" onclick="removeVehicleType(this)">ì‚­ì œ</button>
                                </div>
                            </div>
                            <button class="btn-admin btn-success" onclick="addVehicleType()">+ ì°¨ì¢… ì¶”ê°€</button>
                        </div>
                    </div>
                    <div class="admin-button-container">
                        <button class="btn-admin btn-primary" onclick="saveVehicleTypes()">ì°¨ì¢… ì„¤ì • ì €ì¥</button>
                        <button class="btn-admin btn-warning" onclick="loadVehicleTypes()">ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸°</button>
                        <button class="btn-admin btn-danger" onclick="resetVehicleTypes()">ê¸°ë³¸ê°’ìœ¼ë¡œ ì´ˆê¸°í™”</button>
                    </div>
                </div>
                
                <div class="admin-button-container">
                    <button class="btn-admin btn-success" onclick="viewHardwareMapping()">ë§¤í•‘ í™•ì¸</button>
                    <button class="btn-admin btn-warning" onclick="testMapping('hardware-management')">ë§¤í•‘ í…ŒìŠ¤íŠ¸</button>
                </div>
            </div>
        </div>

        <!-- ì¥ë¹„ê´€ë¦¬ í•„ë“œ ë§¤í•‘ -->
        <div class="section-card">
            <div class="section-header">
                <h3>ğŸ”§ ì¥ë¹„ê´€ë¦¬ í•„ë“œ ë§¤í•‘</h3>
                <p>ì¥ë¹„ ê´€ë¦¬ì˜ ê° í•„ë“œë¥¼ Codebeamerì˜ í•´ë‹¹ í•„ë“œì™€ ë§¤í•‘í•©ë‹ˆë‹¤.</p>
            </div>
            <div class="section-content">
                <div class="field-mapping">
                    <div class="field-group">
                        <h4>ì¥ë¹„ ê¸°ë³¸ ì •ë³´</h4>
                        <div class="field-item">
                            <span class="field-label">ì¥ë¹„ëª…</span>
                            <input type="text" class="field-mapping-input" value="name" readonly>
                        </div>
                        <div class="field-item">
                            <span class="field-label">ì¹´í…Œê³ ë¦¬</span>
                            <input type="text" class="field-mapping-input" value="custom_field_14">
                        </div>
                        <div class="field-item">
                            <span class="field-label">ì œì¡°ì‚¬</span>
                            <input type="text" class="field-mapping-input" value="custom_field_15">
                        </div>
                        <div class="field-item">
                            <span class="field-label">ëª¨ë¸ëª…</span>
                            <input type="text" class="field-mapping-input" value="custom_field_16">
                        </div>
                        <div class="field-item">
                            <span class="field-label">ì‹œë¦¬ì–¼ ë²ˆí˜¸</span>
                            <input type="text" class="field-mapping-input" value="custom_field_17">
                        </div>
                    </div>
                    <div class="field-group">
                        <h4>ì¥ë¹„ ìƒì„¸ ì •ë³´</h4>
                        <div class="field-item">
                            <span class="field-label">êµ¬ë§¤ì¼</span>
                            <input type="text" class="field-mapping-input" value="custom_field_18">
                        </div>
                        <div class="field-item">
                            <span class="field-label">ë³´ì¦ë§Œë£Œì¼</span>
                            <input type="text" class="field-mapping-input" value="custom_field_19">
                        </div>
                        <div class="field-item">
                            <span class="field-label">ì„¤ì¹˜ìœ„ì¹˜</span>
                            <input type="text" class="field-mapping-input" value="custom_field_20">
                        </div>
                        <div class="field-item">
                            <span class="field-label">ë‹´ë‹¹ì</span>
                            <input type="text" class="field-mapping-input" value="custom_field_21">
                        </div>
                        <div class="field-item">
                            <span class="field-label">ì‚¬ì–‘</span>
                            <input type="text" class="field-mapping-input" value="description">
                        </div>
                        <div class="field-item">
                            <span class="field-label">ë¹„ê³ </span>
                            <input type="text" class="field-mapping-input" value="custom_field_22">
                        </div>
                    </div>
                </div>
                <div class="admin-button-container">
                    <button class="btn-admin btn-primary" onclick="saveMapping('equipment-management')">ë§¤í•‘ ì €ì¥</button>
                    <button class="btn-admin btn-warning" onclick="testMapping('equipment-management')">ë§¤í•‘ í…ŒìŠ¤íŠ¸</button>
                </div>
            </div>
        </div>

        <!-- ì™¸ë¶€êµìœ¡ê´€ë¦¬ í•„ë“œ ë§¤í•‘ -->
        <div class="section-card">
            <div class="section-header">
                <h3>ğŸ“ ì™¸ë¶€êµìœ¡ê´€ë¦¬ í•„ë“œ ë§¤í•‘</h3>
                <p>ì™¸ë¶€ êµìœ¡ ê´€ë¦¬ì˜ ê° í•„ë“œë¥¼ Codebeamerì˜ í•´ë‹¹ í•„ë“œì™€ ë§¤í•‘í•©ë‹ˆë‹¤.</p>
            </div>
            <div class="section-content">
                <div class="field-mapping">
                    <div class="field-group">
                        <h4>êµìœ¡ ê¸°ë³¸ ì •ë³´</h4>
                        <div class="field-item">
                            <span class="field-label">êµìœ¡ëª…</span>
                            <input type="text" class="field-mapping-input" value="name" readonly>
                        </div>
                        <div class="field-item">
                            <span class="field-label">êµìœ¡ê¸°ê´€</span>
                            <input type="text" class="field-mapping-input" value="custom_field_23">
                        </div>
                        <div class="field-item">
                            <span class="field-label">êµìœ¡ìœ í˜•</span>
                            <input type="text" class="field-mapping-input" value="custom_field_24">
                        </div>
                        <div class="field-item">
                            <span class="field-label">êµìœ¡ì‹œì‘ì¼</span>
                            <input type="text" class="field-mapping-input" value="custom_field_25">
                        </div>
                        <div class="field-item">
                            <span class="field-label">êµìœ¡ì¢…ë£Œì¼</span>
                            <input type="text" class="field-mapping-input" value="custom_field_26">
                        </div>
                    </div>
                    <div class="field-group">
                        <h4>êµìœ¡ ìƒì„¸ ì •ë³´</h4>
                        <div class="field-item">
                            <span class="field-label">êµìœ¡ì¥ì†Œ</span>
                            <input type="text" class="field-mapping-input" value="custom_field_27">
                        </div>
                        <div class="field-item">
                            <span class="field-label">ì°¸ì„ì</span>
                            <input type="text" class="field-mapping-input" value="custom_field_28">
                        </div>
                        <div class="field-item">
                            <span class="field-label">ìˆ˜ê°•ë£Œ</span>
                            <input type="text" class="field-mapping-input" value="custom_field_29">
                        </div>
                        <div class="field-item">
                            <span class="field-label">ìˆ™ë°•ë¹„</span>
                            <input type="text" class="field-mapping-input" value="custom_field_30">
                        </div>
                        <div class="field-item">
                            <span class="field-label">êµí†µë¹„</span>
                            <input type="text" class="field-mapping-input" value="custom_field_31">
                        </div>
                        <div class="field-item">
                            <span class="field-label">ì‹ë¹„</span>
                            <input type="text" class="field-mapping-input" value="custom_field_32">
                        </div>
                        <div class="field-item">
                            <span class="field-label">êµìœ¡ë‚´ìš©</span>
                            <input type="text" class="field-mapping-input" value="description">
                        </div>
                        <div class="field-item">
                            <span class="field-label">ê¸°ëŒ€íš¨ê³¼</span>
                            <input type="text" class="field-mapping-input" value="custom_field_33">
                        </div>
                    </div>
                </div>
                <div class="admin-button-container">
                    <button class="btn-admin btn-primary" onclick="saveMapping('external-training')">ë§¤í•‘ ì €ì¥</button>
                    <button class="btn-admin btn-warning" onclick="testMapping('external-training')">ë§¤í•‘ í…ŒìŠ¤íŠ¸</button>
                </div>
            </div>
        </div>

        <!-- ì‹œìŠ¤í…œ ì„¤ì • -->
        <div class="section-card">
            <div class="section-header">
                <h3>âš™ï¸ ì‹œìŠ¤í…œ ì„¤ì •</h3>
                <p>ì „ì²´ ì‹œìŠ¤í…œ ì„¤ì • ë° Codebeamer ì—°ë™ ì„¤ì •ì„ ê´€ë¦¬í•©ë‹ˆë‹¤.</p>
            </div>
            <div class="section-content">
                <div class="field-mapping">
                    <div class="field-group">
                        <h4>Codebeamer ì„¤ì •</h4>
                        <div class="field-item">
                            <span class="field-label">API URL</span>
                            <input type="text" class="field-mapping-input" value="<%= serverUrl %>" readonly>
                        </div>
                        <div class="field-item">
                            <span class="field-label">í”„ë¡œì íŠ¸ ID</span>
                            <input type="text" class="field-mapping-input" value="project_id">
                        </div>
                        <div class="field-item">
                            <span class="field-label">íŠ¸ë˜ì»¤ ID (ì£¼ê°„ë³´ê³ )</span>
                            <input type="text" class="field-mapping-input" value="tracker_weekly">
                        </div>
                        <div class="field-item">
                            <span class="field-label">íŠ¸ë˜ì»¤ ID (ì¶œì¥ë³´ê³ )</span>
                            <input type="text" class="field-mapping-input" value="tracker_travel">
                        </div>
                        <div class="field-item">
                            <span class="field-label">íŠ¸ë˜ì»¤ ID (í•˜ë“œì›¨ì–´)</span>
                            <input type="text" class="field-mapping-input" value="19601" readonly>
                        </div>
                        <div class="field-item">
                            <span class="field-label">íŠ¸ë˜ì»¤ ID (ì¥ë¹„)</span>
                            <input type="text" class="field-mapping-input" value="tracker_equipment">
                        </div>
                        <div class="field-item">
                            <span class="field-label">íŠ¸ë˜ì»¤ ID (êµìœ¡)</span>
                            <input type="text" class="field-mapping-input" value="tracker_training">
                        </div>
                    </div>
                    <div class="field-group">
                        <h4>ì‹œìŠ¤í…œ ì„¤ì •</h4>
                        <div class="field-item">
                            <span class="field-label">ìë™ ë™ê¸°í™”</span>
                            <input type="checkbox" class="admin-checkbox-auto">
                        </div>
                        <div class="field-item">
                            <span class="field-label">ë™ê¸°í™” ì£¼ê¸° (ë¶„)</span>
                            <input type="number" class="field-mapping-input" value="30">
                        </div>
                        <div class="field-item">
                            <span class="field-label">ë¡œê·¸ ë ˆë²¨</span>
                            <select class="field-mapping-input">
                                <option value="debug">Debug</option>
                                <option value="info" selected>Info</option>
                                <option value="warn">Warning</option>
                                <option value="error">Error</option>
                            </select>
                        </div>
                        <div class="field-item">
                            <span class="field-label">ë°±ì—… í™œì„±í™”</span>
                            <input type="checkbox" checked class="admin-checkbox-auto">
                        </div>
                        <div class="field-item">
                            <span class="field-label">ë°±ì—… ì£¼ê¸° (ì¼)</span>
                            <input type="number" class="field-mapping-input" value="7">
                        </div>
                    </div>
                </div>
                <div class="admin-button-container">
                    <button class="btn-admin btn-primary" onclick="saveSystemSettings()">ì„¤ì • ì €ì¥</button>
                    <button class="btn-admin btn-success" onclick="testConnection()">ì—°ê²° í…ŒìŠ¤íŠ¸</button>
                    <button class="btn-admin btn-warning" onclick="syncAllData()">ì „ì²´ ë™ê¸°í™”</button>
                    <button class="btn-admin btn-danger" onclick="resetSettings()">ì„¤ì • ì´ˆê¸°í™”</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Check Codebeamer connection status
        async function checkConnection() {
            try {
                const response = await fetch('/api/debug/ping');
                const data = await response.json();
                const statusElement = document.getElementById('connectionStatus');
                
                if (data.success) {
                    statusElement.textContent = 'ì—°ê²°ë¨';
                    statusElement.style.color = '#28a745';
                } else {
                    statusElement.textContent = 'ì—°ê²° ì‹¤íŒ¨';
                    statusElement.style.color = '#dc3545';
                }
            } catch (error) {
                document.getElementById('connectionStatus').textContent = 'ì—°ê²° ì‹¤íŒ¨';
                document.getElementById('connectionStatus').style.color = '#dc3545';
            }
        }

        // Update mapping statistics
        function updateMappingStats() {
            const mappedCount = document.querySelectorAll('.field-mapping-input[readonly]').length;
            const totalFields = document.querySelectorAll('.field-mapping-input').length;
            const pendingCount = Math.floor(totalFields * 0.3);
            const unmappedCount = totalFields - mappedCount - pendingCount;
            
            document.getElementById('mappedCount').textContent = mappedCount;
            document.getElementById('pendingCount').textContent = pendingCount;
            document.getElementById('unmappedCount').textContent = unmappedCount;
        }

        // Save field mapping
        function saveMapping(section) {
            const inputs = document.querySelectorAll(`[data-section="${section}"] .field-mapping-input`);
            const mapping = {};
            
            inputs.forEach(input => {
                const label = input.previousElementSibling.textContent;
                mapping[label] = input.value;
            });
            
            console.log(`Saving mapping for ${section}:`, mapping);
            alert(`${section} í•„ë“œ ë§¤í•‘ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.`);
        }

        // Test field mapping
        function testMapping(section) {
            console.log(`Testing mapping for ${section}`);
            alert(`${section} í•„ë“œ ë§¤í•‘ í…ŒìŠ¤íŠ¸ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.`);
        }

        // View hardware mapping (read-only)
        function viewHardwareMapping() {
            alert('í•˜ë“œì›¨ì–´ê´€ë¦¬ëŠ” ì´ë¯¸ Codebeamerì™€ ì—°ë™ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\ní˜„ì¬ ë§¤í•‘ëœ í•„ë“œë“¤ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
        }

        // Save system settings
        function saveSystemSettings() {
            console.log('Saving system settings...');
            alert('ì‹œìŠ¤í…œ ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        // Test connection
        function testConnection() {
            checkConnection();
        }

        // Sync all data
        function syncAllData() {
            console.log('Syncing all data...');
            alert('ì „ì²´ ë°ì´í„° ë™ê¸°í™”ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.');
        }

        // Reset settings
        function resetSettings() {
            if (confirm('ì •ë§ë¡œ ëª¨ë“  ì„¤ì •ì„ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                console.log('Resetting settings...');
                alert('ì„¤ì •ì´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        }

        // Toggle Vehicle Type Configuration
        function toggleVehicleTypeConfig() {
            const configDiv = document.getElementById('vehicleTypeConfig');
            const toggleBtn = document.getElementById('vehicleTypeToggleBtn');
            const toggleText = document.getElementById('vehicleTypeToggleText');
            
            if (configDiv.style.display === 'none') {
                configDiv.style.display = 'block';
                toggleText.textContent = 'ì°¨ì¢… ì„¤ì • ë‹«ê¸°';
                toggleBtn.classList.add('btn-warning');
                toggleBtn.classList.remove('btn-info');
            } else {
                configDiv.style.display = 'none';
                toggleText.textContent = 'ì°¨ì¢… ì„¤ì • ì—´ê¸°';
                toggleBtn.classList.add('btn-info');
                toggleBtn.classList.remove('btn-warning');
            }
        }

        // Vehicle Type Management Functions
        function addVehicleType() {
            const container = document.getElementById('vehicleTypeOptions');
            const newItem = document.createElement('div');
            newItem.className = 'vehicle-type-item';
            newItem.innerHTML = `
                <input type="text" class="field-mapping-input vehicle-type-input" placeholder="ì°¨ì¢…ëª… ì…ë ¥" value="">
                <button class="btn-admin btn-danger btn-small" onclick="removeVehicleType(this)">ì‚­ì œ</button>
            `;
            container.appendChild(newItem);
        }

        function removeVehicleType(button) {
            const container = document.getElementById('vehicleTypeOptions');
            if (container.children.length > 1) {
                button.parentElement.remove();
            } else {
                alert('ìµœì†Œ í•˜ë‚˜ì˜ ì°¨ì¢…ì€ ìœ ì§€í•´ì•¼ í•©ë‹ˆë‹¤.');
            }
        }

        function getVehicleTypes() {
            const inputs = document.querySelectorAll('.vehicle-type-input');
            const vehicleTypes = [];
            inputs.forEach(input => {
                if (input.value.trim()) {
                    vehicleTypes.push(input.value.trim());
                }
            });
            return vehicleTypes;
        }

        function setVehicleTypes(vehicleTypes) {
            const container = document.getElementById('vehicleTypeOptions');
            container.innerHTML = '';
            
            vehicleTypes.forEach(type => {
                const newItem = document.createElement('div');
                newItem.className = 'vehicle-type-item';
                newItem.innerHTML = `
                    <input type="text" class="field-mapping-input vehicle-type-input" placeholder="ì°¨ì¢…ëª… ì…ë ¥" value="${type}">
                    <button class="btn-admin btn-danger btn-small" onclick="removeVehicleType(this)">ì‚­ì œ</button>
                `;
                container.appendChild(newItem);
            });
        }

        async function saveVehicleTypes() {
            const vehicleTypes = getVehicleTypes();
            
            if (vehicleTypes.length === 0) {
                alert('ìµœì†Œ í•˜ë‚˜ì˜ ì°¨ì¢…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            try {
                const response = await fetch('/api/admin/vehicle-types', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ vehicleTypes })
                });

                const data = await response.json();
                
                if (data.success) {
                    alert('ì°¨ì¢… ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
                } else {
                    alert('ì°¨ì¢… ì„¤ì • ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + data.error);
                }
            } catch (error) {
                console.error('Error saving vehicle types:', error);
                alert('ì°¨ì¢… ì„¤ì • ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        async function loadVehicleTypes() {
            try {
                const response = await fetch('/api/admin/vehicle-types');
                const data = await response.json();
                
                if (data.success) {
                    setVehicleTypes(data.vehicleTypes);
                    alert('ì°¨ì¢… ì„¤ì •ì„ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.');
                } else {
                    alert('ì°¨ì¢… ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + data.error);
                }
            } catch (error) {
                console.error('Error loading vehicle types:', error);
                alert('ì°¨ì¢… ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        function resetVehicleTypes() {
            if (confirm('ê¸°ë³¸ ì°¨ì¢… ì„¤ì •ìœ¼ë¡œ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                const defaultTypes = ['SW', 'OV1', 'HE1i', 'SX3', 'NQ6', 'LT2'];
                setVehicleTypes(defaultTypes);
            }
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            checkConnection();
            updateMappingStats();
            loadVehicleTypes();
        });
    </script>
</body>
</html>
