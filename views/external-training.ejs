<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="/images/favicon.ico">
    <title>Doowon Portal - ì™¸ë¶€êµìœ¡ê´€ë¦¬</title>
    <link rel="stylesheet" type="text/css" href="css/style.css" />
    <link rel="stylesheet" type="text/css" href="css/darkmode.css" />
    <link rel="stylesheet" type="text/css" href="css/table.css" />
</head>

<body>
    <header class="header">
        <div class="logo"><a href="http://211.238.111.33:8080/cb/"><img src="images/doowon_logo.png" alt="Logo" /></a></div>
        <div class="title-container"><h1>Doowon Portal</h1><p>ë‘ì›ê³µì¡° í¬íƒˆ</p></div>
        <div class="menu-container">
            <span class="menu-item"><img src="images/user.svg" alt="User" /><%= username %></span>
            <a href="#" class="menu-item" onclick="handleLogout()"><img src="images/logout.svg" alt="Logout" />Logout</a>
        </div>                  
    </header>

    <nav class="main-nav">
        <div class="nav-container">
            <a href="/" class="nav-item <%= currentPath === '/' ? 'active' : '' %>">
                <img src="images/home.svg" alt="Home" />
                <span>ëŒ€ì‹œë³´ë“œ</span>
            </a>
            <a href="/weekly-reports" class="nav-item <%= currentPath === '/weekly-reports' ? 'active' : '' %>">
                <img src="images/settings.svg" alt="Weekly Reports" />
                <span>ì£¼ê°„ë³´ê³ ê´€ë¦¬</span>
            </a>
            <a href="/travel-reports" class="nav-item <%= currentPath === '/travel-reports' ? 'active' : '' %>">
                <img src="images/settings.svg" alt="Travel Reports" />
                <span>ì¶œì¥ë³´ê³ ê´€ë¦¬</span>
            </a>
            <a href="/hardware-management" class="nav-item <%= currentPath === '/hardware-management' ? 'active' : '' %>">
                <img src="images/settings.svg" alt="Hardware Management" />
                <span>í•˜ë“œì›¨ì–´ê´€ë¦¬</span>
            </a>
            <a href="/equipment-management" class="nav-item <%= currentPath === '/equipment-management' ? 'active' : '' %>">
                <img src="images/settings.svg" alt="Equipment Management" />
                <span>ì¥ë¹„ê´€ë¦¬</span>
            </a>
            <a href="/external-training" class="nav-item <%= currentPath === '/external-training' ? 'active' : '' %>">
                <img src="images/settings.svg" alt="External Training" />
                <span>ì™¸ë¶€êµìœ¡ê´€ë¦¬</span>
            </a>
        </div>
        <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">â˜°</button>
        <div class="mobile-nav" id="mobileNav">
            <a href="/" class="nav-item <%= currentPath === '/' ? 'active' : '' %>">
                <img src="images/home.svg" alt="Home" />
                <span>ëŒ€ì‹œë³´ë“œ</span>
            </a>
            <a href="/weekly-reports" class="nav-item <%= currentPath === '/weekly-reports' ? 'active' : '' %>">
                <img src="images/settings.svg" alt="Weekly Reports" />
                <span>ì£¼ê°„ë³´ê³ ê´€ë¦¬</span>
            </a>
            <a href="/travel-reports" class="nav-item <%= currentPath === '/travel-reports' ? 'active' : '' %>">
                <img src="images/settings.svg" alt="Travel Reports" />
                <span>ì¶œì¥ë³´ê³ ê´€ë¦¬</span>
            </a>
            <a href="/hardware-management" class="nav-item <%= currentPath === '/hardware-management' ? 'active' : '' %>">
                <img src="images/settings.svg" alt="Hardware Management" />
                <span>í•˜ë“œì›¨ì–´ê´€ë¦¬</span>
            </a>
            <a href="/equipment-management" class="nav-item <%= currentPath === '/equipment-management' ? 'active' : '' %>">
                <img src="images/settings.svg" alt="Equipment Management" />
                <span>ì¥ë¹„ê´€ë¦¬</span>
            </a>
            <a href="/external-training" class="nav-item <%= currentPath === '/external-training' ? 'active' : '' %>">
                <img src="images/settings.svg" alt="External Training" />
                <span>ì™¸ë¶€êµìœ¡ê´€ë¦¬</span>
            </a>
        </div>
    </nav>

    <div class="main-container">
        <div class="page-header">
            <h2>ğŸ“ ì™¸ë¶€êµìœ¡ê´€ë¦¬</h2>
            <p>ì™¸ë¶€ êµìœ¡ ì‹ ì²­, ì°¸ì„ ë° ìˆ˜ë£Œë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
        </div>

        <div class="content-section">
            <div class="section-header">
                <h3>ìƒˆ êµìœ¡ ì‹ ì²­</h3>
                <button class="btn-primary" onclick="showCreateForm()">+ ìƒˆ êµìœ¡ ì‹ ì²­</button>
            </div>

            <div class="create-form" id="createForm" style="display: none;">
                <form id="trainingForm">
                    <div class="form-group">
                        <label for="trainingTitle">êµìœ¡ëª…</label>
                        <input type="text" id="trainingTitle" name="title" required placeholder="êµìœ¡ëª…ì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="trainingProvider">êµìœ¡ê¸°ê´€</label>
                            <input type="text" id="trainingProvider" name="provider" required placeholder="êµìœ¡ê¸°ê´€ëª…ì„ ì…ë ¥í•˜ì„¸ìš”">
                        </div>
                        <div class="form-group">
                            <label for="trainingType">êµìœ¡ìœ í˜•</label>
                            <select id="trainingType" name="type" required>
                                <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                                <option value="technical">ê¸°ìˆ êµìœ¡</option>
                                <option value="safety">ì•ˆì „êµìœ¡</option>
                                <option value="management">ê´€ë¦¬êµìœ¡</option>
                                <option value="certification">ìê²©ì¦êµìœ¡</option>
                                <option value="language">ì–´í•™êµìœ¡</option>
                                <option value="other">ê¸°íƒ€</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="startDate">êµìœ¡ì‹œì‘ì¼</label>
                            <input type="date" id="startDate" name="startDate" required>
                        </div>
                        <div class="form-group">
                            <label for="endDate">êµìœ¡ì¢…ë£Œì¼</label>
                            <input type="date" id="endDate" name="endDate" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="location">êµìœ¡ì¥ì†Œ</label>
                            <input type="text" id="location" name="location" required placeholder="êµìœ¡ì¥ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                        </div>
                        <div class="form-group">
                            <label for="participants">ì°¸ì„ì</label>
                            <input type="text" id="participants" name="participants" placeholder="ì°¸ì„ìëª…ì„ ì…ë ¥í•˜ì„¸ìš” (ì‰¼í‘œë¡œ êµ¬ë¶„)">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="trainingCost">êµìœ¡ë¹„</label>
                        <div class="cost-grid">
                            <div class="cost-item">
                                <label for="tuition">ìˆ˜ê°•ë£Œ</label>
                                <input type="number" id="tuition" name="tuition" placeholder="0" min="0">
                            </div>
                            <div class="cost-item">
                                <label for="accommodation">ìˆ™ë°•ë¹„</label>
                                <input type="number" id="accommodation" name="accommodation" placeholder="0" min="0">
                            </div>
                            <div class="cost-item">
                                <label for="transportation">êµí†µë¹„</label>
                                <input type="number" id="transportation" name="transportation" placeholder="0" min="0">
                            </div>
                            <div class="cost-item">
                                <label for="meals">ì‹ë¹„</label>
                                <input type="number" id="meals" name="meals" placeholder="0" min="0">
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="trainingContent">êµìœ¡ë‚´ìš©</label>
                        <textarea id="trainingContent" name="content" rows="6" required placeholder="êµìœ¡ ë‚´ìš©ì„ ì‘ì„±í•˜ì„¸ìš”..."></textarea>
                    </div>

                    <div class="form-group">
                        <label for="expectedOutcome">ê¸°ëŒ€íš¨ê³¼</label>
                        <textarea id="expectedOutcome" name="outcome" rows="4" placeholder="êµìœ¡ì„ í†µí•´ ì–»ê³ ì í•˜ëŠ” íš¨ê³¼ë¥¼ ì‘ì„±í•˜ì„¸ìš”..."></textarea>
                    </div>

                    <div class="form-group">
                        <label for="trainingAttachments">ì²¨ë¶€íŒŒì¼</label>
                        <input type="file" id="trainingAttachments" name="attachments" multiple accept=".pdf,.doc,.docx,.xls,.xlsx,.jpg,.jpeg,.png">
                        <small>ì§€ì› í˜•ì‹: PDF, DOC, DOCX, XLS, XLSX, JPG, PNG</small>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="hideCreateForm()">ì·¨ì†Œ</button>
                        <button type="submit" class="btn-primary">êµìœ¡ì‹ ì²­ ì €ì¥</button>
                    </div>
                </form>
            </div>
        </div>

        <div class="content-section">
            <div class="section-header">
                <h3>êµìœ¡ ì‹ ì²­ ëª©ë¡</h3>
                <div class="filter-controls">
                    <select id="statusFilter" onchange="filterTrainings()">
                        <option value="">ì „ì²´ ìƒíƒœ</option>
                        <option value="draft">ì„ì‹œì €ì¥</option>
                        <option value="submitted">ì‹ ì²­ë¨</option>
                        <option value="approved">ìŠ¹ì¸ë¨</option>
                        <option value="rejected">ë°˜ë ¤ë¨</option>
                        <option value="completed">ìˆ˜ë£Œ</option>
                    </select>
                    <select id="typeFilter" onchange="filterTrainings()">
                        <option value="">ì „ì²´ ìœ í˜•</option>
                        <option value="technical">ê¸°ìˆ êµìœ¡</option>
                        <option value="safety">ì•ˆì „êµìœ¡</option>
                        <option value="management">ê´€ë¦¬êµìœ¡</option>
                        <option value="certification">ìê²©ì¦êµìœ¡</option>
                        <option value="language">ì–´í•™êµìœ¡</option>
                        <option value="other">ê¸°íƒ€</option>
                    </select>
                    <input type="month" id="monthFilter" onchange="filterTrainings()" placeholder="ì›”ë³„ í•„í„°">
                </div>
            </div>

            <div class="reports-list" id="trainingsList">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>êµìœ¡ëª…</th>
                            <th>ìƒíƒœ</th>
                            <th>êµìœ¡ê¸°ê´€</th>
                            <th>ê¸°ê°„</th>
                            <th>ìœ í˜•</th>
                            <th>ì´ ë¹„ìš©</th>
                            <th>ì°¸ì„ì</th>
                            <th>ì‹ ì²­ì</th>
                            <th>ì‘ì—…</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>CNC í”„ë¡œê·¸ë˜ë° ê³ ê¸‰ê³¼ì •</strong></td>
                            <td><span class="status-badge status-submitted">ì‹ ì²­ë¨</span></td>
                            <td>í•œêµ­ê¸°ìˆ êµìœ¡ì›</td>
                            <td>2024-02-15 ~ 2024-02-20</td>
                            <td>ê¸°ìˆ êµìœ¡</td>
                            <td>500,000ì›</td>
                            <td>ê¹€ê¸°ìˆ , ì´ê³µì •</td>
                            <td>ê¹€ê¸°ìˆ </td>
                            <td>
                                <button class="btn-small btn-info" onclick="viewTraining(1)">ë³´ê¸°</button>
                                <button class="btn-small btn-warning" onclick="downloadTraining(1)">ë‹¤ìš´ë¡œë“œ</button>
                            </td>
                        </tr>
                        <tr>
                            <td><strong>ì•ˆì „ë³´ê±´êµìœ¡</strong></td>
                            <td><span class="status-badge status-draft">ì„ì‹œì €ì¥</span></td>
                            <td>ì‚°ì—…ì•ˆì „ë³´ê±´ê³µë‹¨</td>
                            <td>2024-03-01 ~ 2024-03-03</td>
                            <td>ì•ˆì „êµìœ¡</td>
                            <td>200,000ì›</td>
                            <td>ë°•ì•ˆì „, ìµœí’ˆì§ˆ</td>
                            <td>ë°•ì•ˆì „</td>
                            <td>
                                <button class="btn-small btn-primary" onclick="editTraining(2)">ìˆ˜ì •</button>
                                <button class="btn-small btn-success" onclick="submitTraining(2)">ì‹ ì²­</button>
                                <button class="btn-small btn-danger" onclick="deleteTraining(2)">ì‚­ì œ</button>
                            </td>
                        </tr>
                        <tr>
                            <td><strong>ISO 9001 í’ˆì§ˆê²½ì˜ì‹œìŠ¤í…œ</strong></td>
                            <td><span class="status-badge status-success">ìˆ˜ë£Œ</span></td>
                            <td>í•œêµ­í’ˆì§ˆì¬ë‹¨</td>
                            <td>2024-01-10 ~ 2024-01-12</td>
                            <td>ìê²©ì¦êµìœ¡</td>
                            <td>300,000ì›</td>
                            <td>ì •í’ˆì§ˆ, í•œê´€ë¦¬</td>
                            <td>ì •í’ˆì§ˆ</td>
                            <td>
                                <button class="btn-small btn-info" onclick="viewTraining(3)">ë³´ê¸°</button>
                                <button class="btn-small btn-success" onclick="downloadCertificate(3)">ìˆ˜ë£Œì¦</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        function handleLogout() {
            fetch('/logout', { method: 'GET' })
                .then(() => window.location.href = '/login')
                .catch(error => console.error('Logout error:', error));
        }

        function toggleMobileMenu() {
            const mobileNav = document.getElementById('mobileNav');
            mobileNav.classList.toggle('active');
        }

        // Close mobile menu when clicking outside
        document.addEventListener('click', function(event) {
            const mobileNav = document.getElementById('mobileNav');
            const mobileMenuToggle = document.querySelector('.mobile-menu-toggle');
            
            if (mobileNav && mobileMenuToggle && 
                !mobileNav.contains(event.target) && 
                !mobileMenuToggle.contains(event.target)) {
                mobileNav.classList.remove('active');
            }
        });

        function showCreateForm() {
            document.getElementById('createForm').style.display = 'block';
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('startDate').value = today;
            document.getElementById('endDate').value = today;
        }

        function hideCreateForm() {
            document.getElementById('createForm').style.display = 'none';
            document.getElementById('trainingForm').reset();
        }

        function filterTrainings() {
            const statusFilter = document.getElementById('statusFilter').value;
            const typeFilter = document.getElementById('typeFilter').value;
            const monthFilter = document.getElementById('monthFilter').value;
            
            console.log('Filtering trainings by status:', statusFilter, 'type:', typeFilter, 'month:', monthFilter);
        }

        function editTraining(id) {
            console.log('Editing training:', id);
            showCreateForm();
        }

        function submitTraining(id) {
            console.log('Submitting training:', id);
        }

        function deleteTraining(id) {
            if (confirm('ì •ë§ë¡œ ì´ êµìœ¡ì‹ ì²­ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                console.log('Deleting training:', id);
            }
        }

        function viewTraining(id) {
            console.log('Viewing training:', id);
        }

        function downloadTraining(id) {
            console.log('Downloading training:', id);
        }

        function downloadCertificate(id) {
            console.log('Downloading certificate for training:', id);
        }

        document.getElementById('trainingForm').addEventListener('submit', function(e) {
            e.preventDefault();
            console.log('Saving training...');
            hideCreateForm();
        });

        // Check if we should show create form on page load
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('action') === 'create') {
                showCreateForm();
            }
        });
    </script>
</body>
</html>
